Hereâ€™s a structured summary of your main files, classes, and their methods, with brief explanations for each. This is suitable as a prompt for an AI to understand your codebase and its architecture.

---

## **main.py**
**Role:**  
Main entry point for the FikFap Scraper application. Handles CLI, argument parsing, and orchestrates the complete workflow.

**Class:**  
- `FikFapScraperApplication`
  - `__init__`: Initializes logger and orchestrator.
  - `run_single_video(post_id, quality_filter)`: Processes a single video post through the workflow.
  - `run_batch_processing(post_ids, max_concurrent, quality_filter)`: Processes multiple videos concurrently.
  - `run_system_check()`: Performs system health checks.
  - `run_interactive_mode()`: Starts an interactive CLI for manual commands.
  - `setup_argument_parser()`: Sets up CLI argument parsing.

**Functions:**  
- `main()`: Main async entry point, parses arguments and runs commands.
- `run_default_demo(app)`: Runs a demo sequence if no command is specified.
- `run()`: Synchronous wrapper for main.

---

## **orchestrator.py**
**Role:**  
Central orchestrator for the entire scraping, extraction, downloading, and storage workflow. Manages component lifecycle, error handling, and system state.

**Class:**  
- `FikFapScraperOrchestrator`
  - `__init__(config_override)`: Initializes all components and dependencies.
  - `_apply_config_overrides(overrides)`: Applies config overrides.
  - `_initialize_components()`: Instantiates all system components.
  - `_configure_component_dependencies()`: Sets up inter-component callbacks.
  - `_register_shutdown_handlers()`: Registers signal handlers for graceful shutdown.
  - `startup()`: Full startup sequence, health checks, and component initialization.
  - `shutdown()`: Graceful shutdown, cleanup, and state saving.
  - `process_video_workflow(post_id, quality_filter, force_reprocess)`: Complete workflow for a single video.
  - `process_multiple_videos(post_ids, max_concurrent, quality_filter)`: Batch processing with concurrency.
  - Internal workflow methods:  
    - `_perform_startup_health_checks()`
    - `_verify_component_health()`
    - `_initialize_storage_system()`
    - `_load_system_state()`
    - `_start_background_tasks()`
    - `_log_system_status()`
    - `_check_duplicate_processing(post_id)`
    - `_check_processing_health()`
    - `_extract_video_data(post_id)`
    - `_select_qualities(video_post, quality_filter)`
    - `_create_storage_structure(video_post)`
    - `_download_qualities(video_post, qualities, directory_structure, job_id)`
    - `_store_downloaded_files(video_post, download_results, directory_structure)`
    - `_save_final_metadata(video_post, storage_results, directory_structure, processing_record)`
  - Context manager methods:  
    - `__aenter__()`
    - `__aexit__()`
  - `get_system_status()`: Returns system and component status.

---

## **enhanced_exceptions.py**
**Role:**  
Defines custom exception classes for robust error handling across all phases.

**Classes:**  
- `OrchestrationError`: Base exception for orchestration errors.
- `StartupError`, `ShutdownError`, `ProcessingError`, `ComponentError`, `ConfigurationError`, `ResourceError`, `NetworkError`, `StorageError`, `ExtractionError`, `DownloadError`: Specialized exceptions for different error scenarios.

---

## **m3u8_downloader.py**
**Role:**  
Handles downloading of videos via M3U8 playlists, including quality selection, progress tracking, and file organization.

**Class:**  
- `M3U8Downloader`
  - `__init__(session)`: Initializes downloader, session, and config.
  - `__aenter__()`, `__aexit__()`: Async context management.
  - `start()`: Initializes session and components.
  - `close()`: Cleans up resources and session.
  - `download_video(video_post, selected_qualities, progress_callback)`: Downloads video in selected qualities.
  - `download_quality(video_post, quality, output_path, progress_callback)`: Downloads a single quality.
  - `_create_download_job(video_post, quality, download_dir, filename)`: Creates a download job.
  - `_execute_download_job(job)`: Executes a download job.
  - `_create_download_directory(video_post)`: Organizes download directories.
  - `_generate_filename(video_post, quality)`: Generates filenames for downloads.
  - `_sanitize_filename(filename)`: Sanitizes filenames for filesystem.
  - `cancel_download(job_id)`: Cancels an active download.
  - `get_download_status(job_id)`: Gets status of a download job.
  - `list_active_downloads()`: Lists all active downloads.
  - `estimate_download_size(video_post)`: Estimates download sizes.
  - `analyze_video_qualities(video_post)`: Analyzes available qualities.
  - `get_quality_summary(video_post)`: Human-readable summary of qualities.
  - `validate_download_prerequisites(video_post)`: Validates prerequisites for download.

---

## **Other Key Files (Referenced, not shown in full)**
- **config.py**: Loads and manages configuration settings.
- **base_scraper.py**: Implements the base scraping logic (browser/API).
- **extractor.py**: Extracts post data from API responses.
- **quality_manager.py**: Manages video quality selection and filtering.
- **file_manager.py**: Handles file organization, naming, and storage.
- **metadata_handler.py**: Manages metadata persistence and processing history.
- **logger.py**: Logging setup and utilities.
- **utils.monitoring.py**: System and disk health monitoring.
- **helpers.py**: Utility functions (formatting, sanitizing, etc.).
- **models.py**: Data models for posts, qualities, authors, statuses, etc.

---

## **Summary Table**

| File/Class                       | Role/Responsibility                                                                                   | Key Methods/Features                                                                                   |
|-----------------------------------|------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| main.py / FikFapScraperApplication| Entry point, CLI, orchestrates workflows                                                             | run_single_video, run_batch_processing, run_system_check, run_interactive_mode, setup_argument_parser  |
| orchestrator.py / FikFapScraperOrchestrator | Central orchestrator, manages all phases, error handling, state, lifecycle                | startup, shutdown, process_video_workflow, process_multiple_videos, get_system_status, internal steps |
| enhanced_exceptions.py            | Custom exceptions for robust error handling                                                          | OrchestrationError, StartupError, ProcessingError, DownloadError, etc.                                 |
| m3u8_downloader.py / M3U8Downloader | Video download system, quality selection, progress, file management                        | download_video, download_quality, cancel_download, estimate_download_size, validate_download_prerequisites |
| config.py                    | Configuration management                                                                             | (various config loading methods)                                                                       |
| base_scraper.py              | Base scraping logic (browser/API)                                                                    | (scraping session methods)                                                                             |
| extractor.py                 | Data extraction from API responses                                                                   | (extract_video_data, etc.)                                                                             |
| quality_manager.py       | Video quality selection/filtering                                                                    | (filter_qualities, select_qualities_for_download, etc.)                                                |
| file_manager.py           | File organization, naming, storage                                                                   | (create_directory_structure, generate_filename, store_video_file, etc.)                                |
| metadata_handler.py       | Metadata persistence, processing history                                                             | (create_processing_record, update_processing_record, save_video_metadata, etc.)                        |
| logger.py                   | Logging utilities                                                                                    | setup_logger                                                                                           |
| utils.monitoring.py               | System/disk health monitoring                                                                        | check_system_health, get_system_status, get_usage_summary                                              |
| helpers.py                  | Utility functions                                                                                    | format_bytes, sanitize_filename                                                                        |
| models.py                    | Data models for posts, qualities, authors, statuses                                                  | VideoPost, VideoQuality, Author, ProcessingStatus, etc.                                                |

---

**This summary provides a clear map of your codebase, the role of each file and class, and the main methods for each.**  
You can use this as a prompt for any AI to understand the architecture and flow of your FikFap Scraper system.